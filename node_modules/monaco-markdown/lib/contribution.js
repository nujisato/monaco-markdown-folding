/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.loadLanguage = loadLanguage;
exports.registerLanguage = registerLanguage;

var _monacoEditor = require("monaco-editor");

var languageDefinitions = {};

function _loadLanguage(languageId) {
  var loader = languageDefinitions[languageId].loader;
  return loader().then(function (mod) {
    _monacoEditor.languages.setMonarchTokensProvider(languageId, mod.language);

    _monacoEditor.languages.setLanguageConfiguration(languageId, mod.conf);
  });
}

var languagePromises = {};

function loadLanguage(languageId) {
  if (!languagePromises[languageId]) {
    languagePromises[languageId] = _loadLanguage(languageId);
  }

  return languagePromises[languageId];
}

function registerLanguage(def) {
  var languageId = def.id;
  languageDefinitions[languageId] = def;

  _monacoEditor.languages.register(def);

  _monacoEditor.languages.onLanguage(languageId, function () {
    loadLanguage(languageId);
  });
}